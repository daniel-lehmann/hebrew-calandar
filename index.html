<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Hebrew Calendar 5786</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="styles.css" />
    <link rel="stylesheet" href="styles/rambam-sun-calc.css" />
  </head>
  <body>
    <div class="app">
      <header class="app-header">
        <h1>Hebrew &amp; Gregorian Calendar</h1>
        <p class="subtitle">Side‑by‑side month view with Hebrew dates &amp; holidays</p>
      </header>

      <main class="app-main">
        <section class="controls">
          <div class="control-group" id="greg-month-group">
            <label for="month-select">Month</label>
            <select id="month-select"></select>
          </div>
          <div class="control-group" id="greg-year-group">
            <label for="year-input">Gregorian Year</label>
            <input id="year-input" type="number" min="1" max="9999" />
          </div>
          <div class="control-group" id="heb-month-group" style="display:none;">
            <label for="heb-month-select">Hebrew Month</label>
            <select id="heb-month-select"></select>
          </div>
          <div class="control-group" id="heb-year-group" style="display:none;">
            <label for="heb-year-input">Hebrew Year</label>
            <input id="heb-year-input" type="number" min="1" max="9999" />
          </div>
          <button id="go-button">Go</button>
          <button id="btn-view-toggle">Hebrew View</button>
        </section>

        <section class="calendars">
          <div class="calendar-panel">
            <div class="calendar-nav">
              <button id="btn-prev-year" class="cal-nav-btn" title="Previous year">&laquo;</button>
              <button id="btn-prev-month" class="cal-nav-btn" title="Previous month">&lsaquo;</button>
              <h2 id="calendar-heading">Month view (Gregorian + Hebrew)</h2>
              <button id="btn-next-month" class="cal-nav-btn" title="Next month">&rsaquo;</button>
              <button id="btn-next-year" class="cal-nav-btn" title="Next year">&raquo;</button>
            </div>
            <div id="combined-calendar" class="calendar-grid"></div>
          </div>
        </section>

        <section class="stats">
          <h2>Hebrew Calendar Stats</h2>

          <!-- Top-level buttons -->
          <div class="stats-controls" id="stats-buttons-row">
            <button id="btn-stats-back" class="stats-back-btn" style="display:none;">&larr; Back</button>
            <button id="btn-tishrei-list" class="stat-btn">List Hebrew date by year</button>
            <button id="btn-tishrei-hist" class="stat-btn">Day-of-week histogram</button>
            <button id="btn-holiday-graph-toggle" class="stat-btn">Holiday line graph</button>
            <button id="btn-dehiyyot-stats" class="stat-btn">Dehiyyot (postponement) stats</button>
            <button id="btn-moon-graph-toggle" class="stat-btn">New moon vs 29d 12h 793h</button>
            <button id="btn-rambam-mean-sun" class="stat-btn">Rambam Kiddush HaChodesh</button>
            <button id="btn-rambam-sun-calc" class="stat-btn">Rambam sun calc (from epoch)</button>
          </div>

          <!-- Panel: Day-of-week histogram -->
          <div class="stats-panel" id="panel-hist" style="display:none;">
            <div class="stats-controls">
              <label for="hist-kind">Show histogram for</label>
              <select id="hist-kind">
                <option value="holiday">Holiday</option>
                <option value="custom">Custom Hebrew date</option>
              </select>
              <select id="hist-holiday-select"></select>
              <select id="hist-month-select" style="display:none;"></select>
              <input id="hist-day-input" type="number" min="1" max="30" placeholder="Day" style="display:none;" />
              <button id="btn-hist-run">Show</button>
            </div>
          </div>

          <!-- Panel: List Hebrew date by year -->
          <div class="stats-panel" id="panel-tishrei-list" style="display:none;">
            <div class="stats-controls">
              <label for="tishrei-years-input">Years</label>
              <input id="tishrei-years-input" type="number" min="1" max="2000" value="19" />
              <label for="hebrew-date-kind">Date type</label>
              <select id="hebrew-date-kind">
                <option value="holiday">Holiday</option>
                <option value="custom">Custom Hebrew date</option>
              </select>
              <select id="hebrew-holiday-select"></select>
              <select id="hebrew-month-select" style="display:none;"></select>
              <input id="hebrew-day-input" type="number" min="1" max="30" placeholder="Day" style="display:none;" />
              <button id="btn-tishrei-list-run">Run</button>
            </div>
          </div>

          <!-- Panel: Holiday line graph -->
          <div class="stats-panel" id="panel-holiday-graph" style="display:none;">
            <div class="stats-controls">
              <label for="holiday-select">Holiday</label>
              <select id="holiday-select"></select>
              <label for="holiday-years-input">Years</label>
              <input id="holiday-years-input" type="number" min="1" max="2000" value="50" />
              <button id="btn-holiday-graph">Show graph</button>
              <button id="btn-cycle-mode">Show specific years of cycle (19 year cycle)</button>
            </div>
            <div class="stats-controls" id="holiday-range-controls" style="display:none;">
              <label for="year-range-slider">Scroll year window</label>
              <input id="year-range-slider" type="range" />
              <span id="year-range-label"></span>
            </div>
            <div class="stats-controls cycle-row" id="cycle-controls" style="display:none;">
              <span>Cycle years (1–19):</span>
              <div id="cycle-checkboxes" class="cycle-checkboxes"></div>
              <button id="btn-cycle-graph">Show cycle graph</button>
            </div>
          </div>

          <!-- Panel: New moon vs 29d 12h 793h -->
          <div class="stats-panel" id="panel-moon-graph" style="display:none;">
            <div class="stats-controls">
              <label for="moon-lines-only-cb">Lines only</label>
              <input id="moon-lines-only-cb" type="checkbox" title="Show only the two mean lines (default 2000 years)" />
              <label for="moon-years-input">Last</label>
              <input id="moon-years-input" type="number" min="1" max="30" value="30" style="width:4em;" />
              <input id="moon-years-slider" type="range" min="1" max="30" value="30" />
              <label>years</label>
            </div>
          </div>

          <!-- Panel: Dehiyyot stats -->
          <div class="stats-panel" id="panel-dehiyyot" style="display:none;">
            <div class="stats-controls">
              <label for="dehiyyot-years-input">Years to analyze (how many years ago)</label>
              <input id="dehiyyot-years-input" type="number" min="1" max="4000" value="1000" />
              <button id="btn-dehiyyot-run">Run</button>
            </div>
            <div id="dehiyyot-results" class="dehiyyot-results"></div>
            <div id="dehiyyot-timeline" class="dehiyyot-timeline"></div>
          </div>

          <!-- Panel: Rambam mean sun explanation (Hilchot Kiddush HaChodesh 12:1) -->
          <div class="stats-panel" id="panel-rambam-mean-sun" style="display:none;">
            <div class="stats-controls">
              <label for="rambam-verse-select">Verse</label>
              <select id="rambam-verse-select"></select>
            </div>
            <div class="rambam-verse-block quote-block">
              <p id="rambam-verse-text" class="rambam-verse-hebrew quote-text" dir="rtl" lang="he"></p>
              <p id="rambam-verse-explanation" class="rambam-verse-explanation"></p>
            </div>
            <div class="rambam-table-wrapper">
              <table id="rambam-mean-sun-table" class="rambam-table"></table>
            </div>
            <div class="rambam-visualization">
              <div class="stats-controls rambam-vis-controls">
                <label>
                  <input type="checkbox" id="rambam-vis-smooth" />
                  Smooth motion
                </label>
              </div>
              <div class="rambam-angle-readout">
                <span id="rambam-angle-mean"></span>
                <span id="rambam-angle-true"></span>
                <span id="rambam-angle-diff"></span>
              </div>
              <svg
                id="rambam-orbit-svg"
                class="rambam-orbit-svg"
                viewBox="-1.5 -1.5 3 3"
                preserveAspectRatio="xMidYMid meet"
                aria-label="Earth orbiting the sun with mean and true angles"
              ></svg>
            </div>
            <div id="rambam-computation-text" class="rambam-computation-text"></div>
            <div class="stats-controls rambam-ecc-controls">
              <label for="rambam-eccentricity-input">
                Eccentricity used in the Rambam-style model
              </label>
              <input
                id="rambam-eccentricity-input"
                type="number"
                min="0"
                max="0.3"
                step="0.00001"
              />
              <span class="hint">
                Small values are realistic (e.g. 0.03–0.04); larger values show a bigger effect in the diagram.
              </span>
            </div>
            <div class="stats-controls rambam-days-controls">
              <label for="rambam-days-input">Compute from daily motion (0° 59′ 8.33″)</label>
              <input id="rambam-days-input" type="number" min="1" step="1" placeholder="Enter number of days" />
            </div>
            <p id="rambam-days-output" class="rambam-days-output"></p>
          </div>

          <!-- Panel: Rambam sun calc from epoch (Nisan 3 4938) -->
          <div class="stats-panel" id="panel-rambam-sun-calc" style="display:none;">
            <p class="rambam-calc-intro">Epoch: Thursday Nisan 3 4938, 0 hours (Hebrew). Day starts at 18:00.</p>
            <div class="rambam-calc-controls stats-controls">
              <label for="rambam-calc-year">Year</label>
              <input id="rambam-calc-year" type="number" min="1" max="9999" value="4938" />
              <label for="rambam-calc-month">Month</label>
              <select id="rambam-calc-month"></select>
              <label for="rambam-calc-day">Day</label>
              <input id="rambam-calc-day" type="number" min="1" max="30" value="14" />
              <label for="rambam-calc-hour">Hour (0 = start of day, 18:00 civil)</label>
              <select id="rambam-calc-hour">
                <option value="0" selected>0</option>
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
                <option value="6">6</option>
                <option value="7">7</option>
                <option value="8">8</option>
                <option value="9">9</option>
                <option value="10">10</option>
                <option value="11">11</option>
                <option value="12">12</option>
                <option value="13">13</option>
                <option value="14">14</option>
                <option value="15">15</option>
                <option value="16">16</option>
                <option value="17">17</option>
                <option value="18">18</option>
                <option value="19">19</option>
                <option value="20">20</option>
                <option value="21">21</option>
                <option value="22">22</option>
                <option value="23">23</option>
              </select>
              <label class="rambam-calc-checkbox-label">
                <input type="checkbox" id="rambam-calc-use-rambam" checked />
                Use Rambam calculation (table, distance rounded to nearest degree)
              </label>
            </div>
            <div id="rambam-calc-output" class="rambam-calc-output"></div>
          </div>

          <!-- Charts -->
          <div class="stats-charts">
            <div class="chart-wrapper" id="holiday-chart-wrapper" style="display:none;">
              <canvas id="holiday-line-chart"></canvas>
            </div>
            <div class="chart-wrapper" id="tishrei-chart-wrapper" style="display:none;">
              <canvas id="tishrei-hist-chart"></canvas>
            </div>
            <div class="chart-wrapper" id="moon-chart-wrapper" style="display:none;">
              <div id="moon-chart-month-lengths" class="moon-chart-month-lengths"></div>
              <canvas id="moon-line-chart"></canvas>
            </div>
          </div>

          <pre id="stats-output" class="stats-output"></pre>
        </section>
      </main>

      <footer class="app-footer">
        <small>Year 5786 Hebrew calendar tools — static HTML, CSS &amp; vanilla JS</small>
      </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <script src="js/api.js"></script>
    <script src="js/moon.js"></script>
    <script src="js/hebrew-core.js"></script>
    <script src="js/stats.js"></script>
    <script src="js/rambam-mean-sun.js"></script>
    <script src="js/rambam-helpers.js"></script>
    <script src="js/rambam-sun-calc.js"></script>
    <script src="js/view.js"></script>
    <script src="js/search.js"></script>
    <script src="data/parashot-data.js"></script>
    <script src="js/parashot.js"></script>
    <script src="js/main.js"></script>
  </body>
</html>

